/* empty css                *//* empty css               *//* empty css                    *//* empty css                  *//* empty css               *//* empty css               *//* empty css                *//* empty css              */import{r as f}from"./request-585909c7.js";import{r as M,o as c,c as g,d as b,e as t,w as a,h as C,E as m,p as $,s as H,C as P,D as q,G as R,m as p,g as V,K as h,F as N,A as E,H as G,I as K,q as L,x as j,l as Q,v as W}from"./index-445d3c97.js";const X={class:"card",style:{"margin-bottom":"5px"}},Y={class:"card",style:{"margin-bottom":"5px"}},Z={key:0,style:{"margin-bottom":"10px"}},ee={class:"card"},le={class:"dialog-footer"},fe={__name:"Course",setup(oe){const e=M({user:JSON.parse(localStorage.getItem("system-user")||"{}"),pageNum:1,pageSize:10,total:0,formVisible:!1,form:{},tableData:[],name:null,collegeData:[],teacherData:[]}),i=()=>{let r=null;e.user.role==="TEACHER"&&(r=e.user.id),f.get("/course/selectPage",{params:{pageNum:e.pageNum,pageSize:e.pageSize,name:e.name,teacherId:r}}).then(l=>{var n,s;e.tableData=(n=l.data)==null?void 0:n.list,e.total=(s=l.data)==null?void 0:s.total})},v=()=>{e.form={},e.formVisible=!0},x=r=>{e.form=JSON.parse(JSON.stringify(r)),e.formVisible=!0},w=()=>{f.post("/course/add",e.form).then(r=>{r.code==="200"?(i(),m.success("操作成功"),e.formVisible=!1):m.error(r.msg)})},D=()=>{f.put("/course/update",e.form).then(r=>{r.code==="200"?(i(),m.success("操作成功"),e.formVisible=!1):m.error(r.msg)})},I=()=>{e.form.id?D():w()},S=r=>{G.confirm("刪除後資料無法恢復，您確定刪除嗎?","刪除確認",{type:"warning"}).then(l=>{f.delete("/course/deleteById/"+r).then(n=>{n.code==="200"?(i(),m.success("操作成功")):m.error(n.msg)})}).catch(l=>{})},U=()=>{e.name=null,i()},z=()=>{f.get("/college/selectAll").then(r=>{r.code==="200"?e.collegeData=r.data:m.error(r.msg)})},A=()=>{f.get("/teacher/selectAll").then(r=>{r.code==="200"?e.teacherData=r.data:m.error(r.msg)})},B=r=>{let l=JSON.parse(JSON.stringify(r));l.studentId=e.user.id,f.post("/choice/add",l).then(n=>{n.code==="200"?(m.success("恭喜你選課成功！"),i()):m.error(n.msg)})};return i(),z(),A(),(r,l)=>{const n=$,s=H,d=K,O=P,T=q,u=L,y=W,_=j,J=Q,F=R;return c(),g("div",null,[b("div",X,[t(n,{modelValue:e.name,"onUpdate:modelValue":l[0]||(l[0]=o=>e.name=o),style:{width:"300px","margin-right":"10px"},placeholder:"請輸入課程名稱查詢"},null,8,["modelValue"]),t(s,{type:"primary",onClick:i},{default:a(()=>l[13]||(l[13]=[p("查詢")])),_:1}),t(s,{type:"info",style:{margin:"0 10px"},onClick:U},{default:a(()=>l[14]||(l[14]=[p("重置")])),_:1})]),b("div",Y,[e.user.role==="ADMIN"?(c(),g("div",Z,[t(s,{type:"primary",onClick:v},{default:a(()=>l[15]||(l[15]=[p("新增")])),_:1})])):C("",!0),t(O,{data:e.tableData,stripe:""},{default:a(()=>[t(d,{label:"課程名稱",prop:"name"}),t(d,{label:"課程介紹",prop:"content","show-overflow-tooltip":""}),t(d,{label:"課程學分",prop:"score"}),t(d,{label:"授課教師",prop:"teacherName"}),t(d,{label:"開班人數",prop:"num"}),t(d,{label:"上課時間",prop:"time"}),t(d,{label:"上課地點",prop:"location"}),t(d,{label:"所屬學院",prop:"collegeName"}),t(d,{label:"已選人數",prop:"alreadyNum"}),e.user.role!=="TEACHER"?(c(),V(d,{key:0,label:"操作",align:"center",width:"160"},h({_:2},[e.user.role==="ADMIN"?{name:"default",fn:a(o=>[t(s,{type:"primary",onClick:k=>x(o.row)},{default:a(()=>l[16]||(l[16]=[p("編輯")])),_:2},1032,["onClick"]),t(s,{type:"danger",onClick:k=>S(o.row.id)},{default:a(()=>l[17]||(l[17]=[p("刪除")])),_:2},1032,["onClick"])]),key:"0"}:{name:"default",fn:a(o=>[t(s,{type:"primary",onClick:k=>B(o.row),disabled:o.row.num===o.row.alreadyNum},{default:a(()=>l[18]||(l[18]=[p("選課")])),_:2},1032,["onClick","disabled"])]),key:"1"}]),1024)):C("",!0)]),_:1},8,["data"])]),b("div",ee,[t(T,{background:"",layout:"prev, pager, next","page-size":e.pageSize,"onUpdate:pageSize":l[1]||(l[1]=o=>e.pageSize=o),"current-page":e.pageNum,"onUpdate:currentPage":l[2]||(l[2]=o=>e.pageNum=o),total:e.total},null,8,["page-size","current-page","total"])]),t(F,{title:"課程資訊",width:"40%",modelValue:e.formVisible,"onUpdate:modelValue":l[12]||(l[12]=o=>e.formVisible=o),"close-on-click-modal":!1,"destroy-on-close":""},{footer:a(()=>[b("span",le,[t(s,{onClick:l[11]||(l[11]=o=>e.formVisible=!1)},{default:a(()=>l[19]||(l[19]=[p("取 消")])),_:1}),t(s,{type:"primary",onClick:I},{default:a(()=>l[20]||(l[20]=[p("保 存")])),_:1})])]),default:a(()=>[t(J,{model:e.form,"label-width":"100px",style:{"padding-right":"50px"}},{default:a(()=>[t(u,{label:"課程名稱",prop:"name"},{default:a(()=>[t(n,{modelValue:e.form.name,"onUpdate:modelValue":l[3]||(l[3]=o=>e.form.name=o),autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(u,{label:"課程介紹",prop:"content"},{default:a(()=>[t(n,{type:"textarea",rows:4,modelValue:e.form.content,"onUpdate:modelValue":l[4]||(l[4]=o=>e.form.content=o),autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(u,{label:"課程學分",prop:"score"},{default:a(()=>[t(n,{modelValue:e.form.score,"onUpdate:modelValue":l[5]||(l[5]=o=>e.form.score=o),autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(u,{label:"授課教師",prop:"teacherId"},{default:a(()=>[t(_,{modelValue:e.form.teacherId,"onUpdate:modelValue":l[6]||(l[6]=o=>e.form.teacherId=o),placeholder:"請選擇教師"},{default:a(()=>[(c(!0),g(N,null,E(e.teacherData,o=>(c(),V(y,{key:o.id,label:o.name,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(u,{label:"開班人數",prop:"num"},{default:a(()=>[t(n,{modelValue:e.form.num,"onUpdate:modelValue":l[7]||(l[7]=o=>e.form.num=o),autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(u,{label:"上課時間",prop:"time"},{default:a(()=>[t(n,{modelValue:e.form.time,"onUpdate:modelValue":l[8]||(l[8]=o=>e.form.time=o),autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(u,{label:"上課地點",prop:"location"},{default:a(()=>[t(n,{modelValue:e.form.location,"onUpdate:modelValue":l[9]||(l[9]=o=>e.form.location=o),autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(u,{label:"所屬學院",prop:"content"},{default:a(()=>[t(_,{modelValue:e.form.collegeId,"onUpdate:modelValue":l[10]||(l[10]=o=>e.form.collegeId=o),placeholder:"請選擇學院"},{default:a(()=>[(c(!0),g(N,null,E(e.collegeData,o=>(c(),V(y,{key:o.id,label:o.name,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}};export{fe as default};
